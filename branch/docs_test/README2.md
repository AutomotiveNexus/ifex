# Documentation development overview

Documentation is generated by a combination of tools and steps:

## Tools:
- The [GitHub actions workflow](/.github/workflows/generate_documentation.yml) encodes the build steps.
- [markup-markdown](https://github.com/hailiang-wang/markup-markdown) is used to combine several markdown files into one.  Some markdown files are static and stored in [[doc-parts]], whereas some are generated from source files.  The naming convention for the definition files are `*.m.md`
- [ifex_ast_doc.py](../ifex/model/ifex_ast_doc.py) generates the main syntax documentation directly from the datatypes used in the internal model AST.  The language definition for the YAML based IDL represents the internal object model.  In the end, both the program behavior _and the documentation of it_ is defined from the python source definition in [ifex_ast.py](../ifex/model/ifex_ast.py)
- The script [create-toc.py](create-toc.py) is used to generate a Table of Contents for the document.

## Source files:
- [def-specification.stage1.m.md](./def-specification.stage1.m.md).  Lists the parts required to produce the main specification.
- [def-specification.stage2.m.md](./def-specification.stage2.m.md).  To combine the specification with the table-of-contents.
- [ifex_ast.py](../ifex/model/ifex_ast.py) is the python source that is interpreted to produce `generated-syntax.md`
- [GitHub actions workflow](./.github/workflow/generate_documentation.yml) defines the build steps.
- [def-developers-manual.m.md](./def-developers-manual.m.md) lists the parts required to produce the developer documentation.

## Build sequence

For developers manual:
- Generate `developers-manual.md` by concatenating multiple files, as specified in `def-developers-manual.m.md` (Work in progress)

For the main specification:
- Build `generated-syntax.md` from python source file.
- Stage 1: Concatenate files as specified in `def-specification.stage1.m.md` to produce temporary file (generated-specification.stage1.md)
- Build Table of Contents (ToC) into temporary file (`generated-toc.md`)
- Stage 2: Build final `ifex-specification.md` by concatenating ToC and specification-contents, as specified by `def-specification.stage2.m.md`

Deployment:
- The GitHub actions workflow goes on to publish the results of the docs directory to the gh-pages branch, which makes it visible at [https://covesa.github.io/ifex-tools](https://covesa.github.io/ifex-tools)
